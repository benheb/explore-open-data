var map;require(["esri/map","dojo/request","esri/geometry/Circle","esri/symbols/SimpleFillSymbol","esri/graphic","esri/layers/GraphicsLayer","esri/geometry/Point","esri/SpatialReference","esri/geometry/webMercatorUtils","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/FeatureLayer","dojo/domReady!"],function(a,o,t,e,c,s,i,r,n){function d(a){var o={geometry:{x:a.geometry.x,y:a.geometry.y,spatialReference:{wkid:102100}},attributes:{title:a.attributes.title,datasets:a.attributes.datasets_count,url:a.attributes.url,groups:a.attributes.groups_count},symbol:{color:[237,50,133,128],size:Math.min(Math.round(a.attributes.datasets_count/100*40),50),angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[171,23,89,200],width:1,type:"esriSLS",style:"esriSLSSolid"}}},t=new c(o);m.add(t)}function p(a){var o=a.graphic.attributes.datasets,t=a.graphic.attributes.title,e=a.graphic.attributes.groups;$("#title").html(t),$("#groups").html("Open Data Groups: "+e),$("#count").html("Datasets: "+o)}function g(a){""!==a.graphic.attributes.url&&null!==a.graphic.attributes.url&&window.open(a.graphic.attributes.url)}esriConfig.defaults.map.basemaps.dotted={baseMapLayers:[{url:"http://studio.esri.com/arcgis/rest/services/World/WorldBasemapBlack/MapServer"}],title:"dots"},map=new a("map",{center:[-56.049,38.485],zoom:3,basemap:"dotted"});var m=new s({id:"circles"});map.addLayer(m),m.on("mouse-over",function(a){p(a)}),m.on("click",function(a){g(a)}),m.on("mouse-out",function(){});var l=["eprinkrez.vrk.opendata.arcgis.com","alabama.pluton.opendata.arcgis.com","maps.acpa.opendata.arcgis.com","aampo.mpo.opendata.arcgis.com","gisdata.arlgis.opendata.arcgis.com","banen.banedanmark.opendata.arcgis.com","gis.bexar.opendata.arcgis.com","bostonopendata.boston.opendata.arcgis.com","open.brampton.opendata.arcgis.com","spatial.cml.opendata.arcgis.com","gis.ecan.opendata.arcgis.com","gis.cccommission.opendata.arcgis.com","data.carver.opendata.arcgis.com","gisdata.azwater.opendata.arcgis.com","andes.ccrp.opendata.arcgis.com","data.alexgis.opendata.arcgis.com","data.annapolis.opendata.arcgis.com","data.bellingham.opendata.arcgis.com","opendata.bismarck.opendata.arcgis.com","opendata.boise.opendata.arcgis.com","public.chesva.opendata.arcgis.com","data.dentontxgis.opendata.arcgis.com","data.dublinohio.opendata.arcgis.com","maps.fallschurch.opendata.arcgis.com","mapss.gahanna.opendata.arcgis.com","cohgis.mycity.opendata.arcgis.com","data.cityoflynchburg.opendata.arcgis.com","cityofpasadenaca.pasgis.opendata.arcgis.com","data.ral.opendata.arcgis.com","geographicdata.slocity.opendata.arcgis.com","gisdata.cityofstafford.opendata.arcgis.com","city.tampa.opendata.arcgis.com","data.cyc.opendata.arcgis.com","clt.charlotte.opendata.arcgis.com","countyassessordatasharingsite.assessoroffice.opendata.arcgis.com","data.countyofriverside.opendata.arcgis.com","gis.slocounty.opendata.arcgis.com","d3.d3.opendata.arcgis.com","gis.dedham.opendata.arcgis.com","data.deptofed.opendata.arcgis.com","opendhn.dhnetwork.opendata.arcgis.com","data.dogis.opendata.arcgis.com","gisdata.evvc.opendata.arcgis.com","fsp.bmgf.opendata.arcgis.com","fultoncountygadataportal.fulcogis.opendata.arcgis.com","data.galwaycoco.opendata.arcgis.com","geohubpathfinder.uwyo.opendata.arcgis.com","catalogue.hrm.opendata.arcgis.com","hcgistn.hamcogis.opendata.arcgis.com","openharfordct.hartfordgis.opendata.arcgis.com","hawaiistatewidegisopendataportal.histategis.opendata.arcgis.com","data.hslhrt.opendata.arcgis.com","data.idfggis.opendata.arcgis.com","data.idwr.opendata.arcgis.com","illinoisepaopendata.illinois-epa.opendata.arcgis.com","incogsopendatasite.incog.opendata.arcgis.com","kygovmaps.kygeonet.opendata.arcgis.com","data.kitcogis.opendata.arcgis.com","lcc.launceston.opendata.arcgis.com","gis.madisonva.opendata.arcgis.com","mauicountydataportal.malama.opendata.arcgis.com","opendata.somdits.opendata.arcgis.com","montereycountyopendata.montereyco.opendata.arcgis.com","data.moco.opendata.arcgis.com","gis.nci.opendata.arcgis.com","njogis.newjersey.opendata.arcgis.com","data.nftwp.opendata.arcgis.com","onswater.bovendams.opendata.arcgis.com","geoportaal.ddh.opendata.arcgis.com","data.odiqueensland.opendata.arcgis.com","lapilot.caro.opendata.arcgis.com","ohdr.nethope.opendata.arcgis.com","opensalem.salem.opendata.arcgis.com","public.colletoncounty.opendata.arcgis.com","data.drcmetro.opendata.arcgis.com","data.pncc.opendata.arcgis.com","gisdata.piercecowa.opendata.arcgis.com","sevilla.idesevilla.opendata.arcgis.com","gis.princegeorges.opendata.arcgis.com","gis.ramathanadiv.opendata.arcgis.com","rinkimuduomenys.vrk.opendata.arcgis.com","roscommon.roscoco.opendata.arcgis.com","gis.slcgov.opendata.arcgis.com","gis.sbcountydpw.opendata.arcgis.com","rdw.sandag.opendata.arcgis.com","odb.sarpy.opendata.arcgis.com","data.saukgis.opendata.arcgis.com","sig.bmo.opendata.arcgis.com","sonomacountyopendata.sonomamap.opendata.arcgis.com","ssmmaopendata.ssmma-gis.opendata.arcgis.com","openstlco.stlcogis.opendata.arcgis.com","equipo.practica.opendata.arcgis.com","arc.garc.opendata.arcgis.com","beta.dcgis.opendata.arcgis.com","imap.maryland.opendata.arcgis.com","vts.bmgf.opendata.arcgis.com","data.brookline.opendata.arcgis.com","data.grotongis.opendata.arcgis.com","town.mooresvillenc.opendata.arcgis.com","udot.uplan.opendata.arcgis.com","geoportal.congeo.opendata.arcgis.com","data.vtanr.opendata.arcgis.com","vicroadsopendata.vicroadsmaps.opendata.arcgis.com","gismaps.vgin.opendata.arcgis.com","vtransparency.vtrans.opendata.arcgis.com","washingtonopendata.wa-geoservices.opendata.arcgis.com","gdl.wadshs.opendata.arcgis.com","data.wake.opendata.arcgis.com","gis.wardnd.opendata.arcgis.com","opendata.wgs.opendata.arcgis.com","gisweb.westspringfield.opendata.arcgis.com","maps.waukeshacounty.opendata.arcgis.com","data.wpsgn.opendata.arcgis.com","wyowildlife.wsfd.opendata.arcgis.com","data.gaiaose.opendata.arcgis.com","library.muroran.opendata.arcgis.com","data.nagareyamamidori.opendata.arcgis.com","dataportal.mtc.opendata.arcgis.com","maps.gahanna.opendata.arcgis.com","www.cavgp.opendata.arcgis.com","tn.tnmap.opendata.arcgis.com","public.hhsproto.opendata.arcgis.com","test.onf.opendata.arcgis.com","data.myfwc.opendata.arcgis.com","honolulu.cchnl.opendata.arcgis.com"];o("http://opendata.arcgis.com/explore.json").then(function(a){var o,t=JSON.parse(a).sites;t.forEach(function(a){var t=a.url.replace(/http:\/\//,"");if(-1!==l.indexOf(t)){var e,c=a.default_extent.xmin+(a.default_extent.xmax-a.default_extent.xmin)/2,s=a.default_extent.ymin+(a.default_extent.ymax-a.default_extent.ymin)/2;if(a.default_extent.spatialReference)if(4326===a.default_extent.spatialReference.wkid){var i=n.lngLatToXY(c,s);e={x:i[0],y:i[1],type:"point",spatialReference:{latestWkid:3857,wkid:102100}}}else e={x:c,y:s,type:"point",spatialReference:{latestWkid:3857,wkid:102100}};else if(4326===a.default_extent.spatial_reference.wkid){var i=n.lngLatToXY(c,s);e={x:i[0],y:i[1],type:"point",spatialReference:{latestWkid:3857,wkid:102100}}}else e={x:c,y:s,type:"point",spatialReference:{latestWkid:3857,wkid:102100}};o={geometry:e,attributes:{title:a.title,url:a.url,created_at:a.created_at,updated_at:a.updated_at,"public":a.public,groups_count:a.groups_count,datasets_count:a.datasets_count}},d(o)}})})});